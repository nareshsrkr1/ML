import pandas as pd
import dask.dataframe as dd
from dask.diagnostics import ProgressBar

# Read the Excel file
xls = pd.ExcelFile('input_file.xlsx')
sheet_names = xls.sheet_names

# Process each sheet and save as separate Excel files using Dask
dfs = [dd.read_excel('input_file.xlsx', sheet_name=sheet, engine='openpyxl') for sheet in sheet_names]

# Save each Dask dataframe as an individual Excel file
total_sheets = len(sheet_names)
with ProgressBar() as pbar:
    for i, (sheet_name, df) in enumerate(zip(sheet_names, dfs), 1):
        df.to_excel(f'{sheet_name}.xlsx', index=False, engine='openpyxl')
        pbar.update(1)

print("Task completed: All sheets processed and saved.")
