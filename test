import pandas as pd
import dask.dataframe as dd

# Read the Excel file using pandas in chunks
chunk_size = 10000
xls = pd.ExcelFile('input_file.xlsx')
sheet_names = xls.sheet_names

# Process each sheet in chunks and save as individual Excel files
for sheet_name in sheet_names:
    print(f"Processing sheet: {sheet_name}")
    writer = pd.ExcelWriter(f'{sheet_name}.xlsx', engine='xlsxwriter')
    for i, chunk in enumerate(pd.read_excel('input_file.xlsx', sheet_name=sheet_name, chunksize=chunk_size)):
        df = dd.from_pandas(chunk, npartitions=1)
        df.compute().to_excel(writer, index=False)
        print(f"Processed chunk {i+1}")
    writer.save()
    print(f"Finished processing sheet: {sheet_name}")
