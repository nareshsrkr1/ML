import pandas as pd
import xlrd

# Read the Excel file using xlrd library
xls = xlrd.open_workbook('InputDataSetLatest.xlsx')
sheet_names = xls.sheet_names()

# Process each sheet and save as separate Excel files
chunksize = 1000
for sheet_name in sheet_names:
    print(f"Processing sheet: {sheet_name}")
    writer = pd.ExcelWriter(f'{sheet_name}_processed.xlsx', engine='xlsxwriter')

    # Read the sheet in chunks and write to the new Excel file
    for start in range(0, xls.sheet_by_name(sheet_name).nrows, chunksize):
        end = min(start + chunksize, xls.sheet_by_name(sheet_name).nrows)
        chunk = pd.read_excel('InputDataSetLatest.xlsx', sheet_name=sheet_name, skiprows=start, nrows=end-start)
        chunk.to_excel(writer, index=False)

    writer.save()
    print(f"Finished processing sheet: {sheet_name}")
